results <- read.table('../../Body/3_Results/linear.regression.kn.ks.vs.generation.length.hsp.like.genes.mammals.txt')
setwd('/Users/redmi/Desktop/HSP/HSP/Head/2Scripts/')
results <- read.table('../../Body/3_Results/linear.regression.kn.ks.vs.generation.length.hsp.like.genes.mammals.txt')
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
rm(list=ls(all=TRUE))
library(ggfortify)
qtl = read.table("../../Body/2_Derived/Gtex.All.sign.pairs.all.tissues.Haploins.txt", header = TRUE)
genes <- qtl$EnsemblId
View(qtl)
boxplot(qtl$NumberGoeEqtl/qtl$NumberLoeEqtl)
boxplot(qtl$NumberGoeEqtl/qtl$NumberEqtl)
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red')
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 2)
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
boxplot(qtl$NumberGoeEqtl/qtl$NumberEqtl)
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
legend('topright', legend = 'HSP90', col = 'red', pch = 19)
legend('topright', legend = 'HSP90', col = 'red', pch = 19, cex = 1/5)
legend('topright', legend = 'HSP90', col = 'red', pch = 19, cex = 1.5)
boxplot(qtl$NumberLoeEqtl/qtl$NumberEqtl)
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberLoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
legend('topright', legend = 'HSP90', col = 'red', pch = 19, cex = 1.5)
boxplot(qtl$NumberGoeEqtl/qtl$NumberEqtl)
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
legend('topright', legend = 'HSP90', col = 'red', pch = 19, cex = 1.5)
boxplot(qtl$NumberGoeEqtl/qtl$NumberLoeEqtl)
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberLoeEqtl'], col = 'red', pch = 19, cex = 1.5)
boxplot(qtl$NumberLoeEqtl/qtl$NumberGoeEqtl)
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberLoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl'], col = 'red', pch = 19, cex = 1.5)
boxplot(qtl$NumberEqtl)
boxplot(qtl$NumberEqtl, ylim = c(0, 1000))
boxplot(qtl$NumberEqtl, ylim = c(0, 10000))
boxplot(qtl$NumberEqtl, ylim = c(0, 5000))
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
boxplot(qtl$NumberGoeEqtl/qtl$NumberEqtl)
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
legend('topright', legend = 'HSP90', col = 'red', pch = 19, cex = 1.5)
hsp_goe_prop <- qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl']
qtl_goe_prop <- qtl$NumberGoeEqtl/qtl$NumberEqtl
(qtl_goe_prop > hsp_goe_prop)
sum(qtl_goe_prop > hsp_goe_prop)
sum(qtl_goe_prop >= hsp_goe_prop)
sum(qtl_goe_prop >= hsp_goe_prop, na.rm = T)
sum(qtl_goe_prop >= hsp_goe_prop, na.rm = T)/length(qtl_goe_prop)
boxplot(qtl$NumberGoeEqtl/qtl$NumberEqtl, ylab = 'Доля GOE вариантов')
points(qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl[qtl$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
legend('topright', legend = 'HSP90', col = 'red', pch = 19, cex = 1.5)
hsp_like_genes = read.table('../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')
hsp_like_genes <- hsp_like_genes[1:300]
hsp_like_genes <- hsp_like_genes[1:300,]
View(hsp_like_genes)
qtl_hsp_like <- qtl[grepl(hsp_like_genes$EnsemblId, qtl$EnsemblId),]
View(qtl_hsp_like)
qtl_hsp_like <- qtl[(hsp_like_genes$EnsemblId %in% qtl$EnsemblId),]
qtl$EnsemblId
qtl_hsp_like <- qtl[(qtl$EnsemblId %in% hsp_like_genes$EnsemblId),]
boxplot(qtl_hsp_like$NumberLoeEqtl/qtl_hsp_like$NumberEqtl)
points(qtl_hsp_like[qtl_hsp_like$EnsemblId == 'ENSG00000096384', 'NumberLoeEqtl']/qtl_hsp_like[qtl_hsp_like$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
legend('topright', legend = 'HSP90', col = 'red', pch = 19, cex = 1.5)
boxplot(qtl_hsp_like$NumberGoeEqtl/qtl_hsp_like$NumberEqtl)
points(qtl_hsp_like[qtl_hsp_like$EnsemblId == 'ENSG00000096384', 'NumberGoeEqtl']/qtl_hsp_like[qtl_hsp_like$EnsemblId == 'ENSG00000096384', 'NumberEqtl'], col = 'red', pch = 19, cex = 1.5)
legend('topright', legend = 'HSP90', col = 'red', pch = 19, cex = 1.5)
rm(list=ls(all=TRUE))
df <- read.table('../../Body/2_Derived/kn.ks.genes.like.hsp.txt')
df[df == 'n/a'] <- NA
names(df)
str(df)
df[, -1] <- sapply(df[, -1], as.vector)
df[, -1] <- sapply(df[, -1], as.numeric)
str(df)
lm_hsp <- lm(df$dN.dS_ENSG00000096384 ~ log10(df$Generation_Length))
plot(df$dN.dS_ENSG00000096384 ~ log10(df$Generation_Length))
abline(df$dN.dS_ENSG00000096384 ~ log10(df$Generation_Length))
abline(lm(df$dN.dS_ENSG00000096384 ~ log10(df$Generation_Length)))
summary(lm)
summary(lm_hsp)
hsp_sp <- df[,c("Species", 'dN.dS_ENSG00000096384')]
View(hsp_sp)
hsp_sp <- na.omit(df[,c("Species", 'dN.dS_ENSG00000096384')])
View(hsp_sp)
write.table(hsp_sp, '../../../../hsp.kn.ks.sp.txt')
hsp_sp <- hsp_sp[order(hsp_sp$dN.dS_ENSG00000096384),]
write.table(hsp_sp, '../../../../hsp.kn.ks.sp.txt')
