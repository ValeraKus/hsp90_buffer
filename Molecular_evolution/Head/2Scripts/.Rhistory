axis.text = element_text(size = 22),
legend.title = element_text(size = 25, face = 'bold'), legend.text = element_text(size = 20))+
labs(colour="Gene")
p2 <- ggplot(hsps[hsps$gene == 'ENSG00000109971' | hsps$gene == 'ENSG00000009335',],aes(x = log10(GenerationLength_d), y = dN.dS, color = role))+
geom_smooth(method = lm, size = 1.6)+
geom_point()+
theme_bw()+
ylab('dN/dS')+
xlab('log10(Generation length, days)')+
scale_color_discrete(name = "Gene", labels = c('HSC70', 'UBE3C'))+
theme(axis.title = element_text(size = 27),
axis.text = element_text(size = 22),
legend.title = element_text(size = 25, face = 'bold'), legend.text = element_text(size = 20))+
labs(colour="Gene")
ggsave('../../Body/4_Figures/hsc70.control.paml.linear.model.dN.dS.vs.genlen.pdf', p2)
setwd('../../../Molecular_evolution/Head/2Scripts/')
rm(list=ls(all=TRUE))
library(ggfortify)
genes <- read.table('../../Body/1_Raw/gencode.v25.annotation.gtf.Genes.Shet.pLI.FIS.RVIS.GHIS.KnKs.GC.BrainSpecificRanking.Branch', header = 1)
HSP_id <- 'ENSG00000096384'
genes_num_cols <- genes[, -c(3,4,5,7, 18)] #18 ÑÑÐ¾Ð»Ð±ÐµÑ - ÑÑÐ¾ "BrainSpecificRanking", ÑÐ±Ð¸ÑÐ°ÐµÐ¼ ÐµÐ³Ð¾ ÑÐ°Ðº ÐºÐ°Ðº Ñ HSP90 ÑÐ°Ð¼ Ð½ÐµÑ Ð½Ð°ÑÐµÐ½Ð¸Ñ
nas <- summary(genes_num_cols)[7,] #Ð¾ÑÐµÐ½Ñ Ð¼Ð½Ð¾Ð³Ð¾ Ð¿ÑÐ¾Ð¿ÑÑÐµÐ½Ð½ÑÑ Ð½Ð°ÑÐµÐ½Ð¸ÐµÐ¹ Ð² ÑÐºÐ¾ÑÐ°Ñ
genes_without_na <- na.omit(genes_num_cols) #Ð¾ÑÑÐ°ÐµÑÑÑ 2435 Ð³ÐµÐ½Ð¾Ð² Ð¸Ð· 58037.
length(unique(genes_without_na$EnsemblId)) # 11536 >> 2435 KOSTYA
DuplGenes = genes_without_na[duplicated(genes_without_na$EnsemblId),]$EnsemblId # ENSG00000167393 ENSG00000168939 ENSG00000182378 ENSG00000198223
genes_without_na = genes_without_na[!genes_without_na$EnsemblId %in% DuplGenes,] # 11532
genes_pca <- prcomp(genes_without_na[,-c(1,2)], scale. = T)
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = qtl_pred, aes(PC1, PC2, color = Group.name))+
geom_label_repel(data=qtl_pred[qtl_pred$Ensembl.gene.ID == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'),
box.padding   = 4,
point.padding = 0.1,
segment.color = 'grey50')+
ggtitle('biplot with hsps')+
theme_bw()
biplot(genes_pca, choices = 2:3, pc.biplot = F, col = c('white', 'black'), cex = 0.6, main = 'PCA HSP like genes', xlim = c(-0.08,0.08))
plot(genes_PC$PC1, genes_PC$PC2, col = 'darkslategray3', xlab = 'PC1 (24% explaned var.)', ylab = 'PC2 (13.4% explaned var.)', main = 'Subset of genes similar to HSP90', asp = 1)
PC1 <- predict(genes_pca)[,1]
PC2 <- predict(genes_pca)[,2]
PC1_var <- summary(genes_pca)$importance[2]
PC2_var <- summary(genes_pca)$importance[5]
genes_labels <- genes_without_na[,c(1,2)]
genes_PC <- data.frame(genes_labels, PC1, PC2)
HspPc1 <- genes_PC[genes_PC$EnsemblId == HSP_id, 3]
HspPc2 <- genes_PC[genes_PC$EnsemblId == HSP_id, 4]
plot(genes_PC$PC1, genes_PC$PC2, col = 'darkslategray3', xlab = 'PC1 (24% explaned var.)', ylab = 'PC2 (13.4% explaned var.)', main = 'Subset of genes similar to HSP90', asp = 1)
points(genes_like_hsp$PC1, genes_like_hsp$PC2, col = 'red')
genes_PC$distance_to_hsp <- sqrt((HspPc1-genes_PC$PC1)**2 + (HspPc2-genes_PC$PC2)**2)
genes_like_hsp <- genes_PC[order(genes_PC$distance_to_hsp)[1:300],]
points(genes_like_hsp$PC1, genes_like_hsp$PC2, col = 'red')
points(genes_like_hsp[genes_like_hsp$EnsemblId == HSP_id,'PC1'], genes_like_hsp[genes_like_hsp$EnsemblId == HSP_id,'PC2'], col = 'black', pch = '*')
groups <- read.csv('../../Body/2_Derived/human.hsp.ensID.group.txt', sep = '\t')
qtl_pred <- merge(x = groups, y = genes_PC, by.x = 'Ensembl.gene.ID', by.y = 'EnsemblId')
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = qtl_pred, aes(PC1, PC2, color = Group.name))+
geom_label_repel(data=qtl_pred[qtl_pred$Ensembl.gene.ID == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'),
box.padding   = 4,
point.padding = 0.1,
segment.color = 'grey50')+
ggtitle('biplot with hsps')+
theme_bw()
View(genes_PC)
View(genes_without_na)
colnames(genes_without_na)
summary(lm(hsp90_control$dN.dS ~ log10(hsp90_control$GenerationLength_d)))
rm(list = ls(all = TRUE))
library(tidyverse)
library(readxl)
library(phytools)
hsps <- read.csv('../../Body/2_Derived/hsps/dN.dS.paml.output.hsps.csv', header = T)
controls <- read.table('../../Body/2_Derived/hsps.with.control.nonhsps.txt')
hsps <- hsps[hsps$dN.dS <= 20,]
hsps$gene <- gsub('_[A-Z|0-9]*', '', hsps$gene)
hsps$role <- ifelse(hsps$gene %in% controls$hsp, 'hsp', 'nonhsp')
hsps$Genus <- gsub('_[a-z]*', '', hsps$Species)
gene_len <- read_excel("../../../Molecular_evolution/Body/1_Raw/Generation Lenght for Mammals.xlsx")
gene_len$Scientific_name <- gsub(' ', '_', gene_len$Scientific_name)
hsps <- merge(hsps, gene_len[,c(2,3,5,6,8,10,14)], by.x = 'Species', by.y = 'Scientific_name', all.x = T)
hsp90 <- hsps[hsps$gene == 'ENSG00000096384' | hsps$gene ==  controls[controls$hsp == 'ENSG00000096384',]$control_gene,]
hsp90_control <- hsps[hsps$gene ==  controls[controls$hsp == 'ENSG00000096384',]$control_gene,]
summary(lm(hsp90$dN.dS ~ log10(hsp90$GenerationLength_d) * hsp90$role))
setwd('../../../Kn.Ks.with.Paml/Head/2Scripts/')
rm(list = ls(all = TRUE))
library(tidyverse)
library(readxl)
library(phytools)
hsps <- read.csv('../../Body/2_Derived/hsps/dN.dS.paml.output.hsps.csv', header = T)
controls <- read.table('../../Body/2_Derived/hsps.with.control.nonhsps.txt')
hsps <- hsps[hsps$dN.dS <= 20,]
hsps$gene <- gsub('_[A-Z|0-9]*', '', hsps$gene)
hsps$role <- ifelse(hsps$gene %in% controls$hsp, 'hsp', 'nonhsp')
hsps$Genus <- gsub('_[a-z]*', '', hsps$Species)
gene_len <- read_excel("../../../Molecular_evolution/Body/1_Raw/Generation Lenght for Mammals.xlsx")
gene_len$Scientific_name <- gsub(' ', '_', gene_len$Scientific_name)
hsps <- merge(hsps, gene_len[,c(2,3,5,6,8,10,14)], by.x = 'Species', by.y = 'Scientific_name', all.x = T)
hsp90 <- hsps[hsps$gene == 'ENSG00000096384' | hsps$gene ==  controls[controls$hsp == 'ENSG00000096384',]$control_gene,]
hsp90_control <- hsps[hsps$gene ==  controls[controls$hsp == 'ENSG00000096384',]$control_gene,]
summary(lm(hsp90$dN.dS ~ log10(hsp90$GenerationLength_d) * hsp90$role))
summary(lm(hsp90[hsp90$gene == 'ENSG00000096384',]$dN.dS ~ log10(hsp90[hsp90$gene == 'ENSG00000096384',]$GenerationLength_d)))
summary(lm(hsp90_control$dN.dS ~ log10(hsp90_control$GenerationLength_d)))
hsc70 <- hsps[hsps$gene == 'ENSG00000109971' | hsps$gene == 'ENSG00000009335',]
summary(lm(hsc70[hsc70$gene == 'ENSG00000109971',]$dN.dS ~ log10(hsc70[hsc70$gene == 'ENSG00000109971',]$GenerationLength_d)))
summary(lm(hsc70[hsc70$gene == 'ENSG00000009335',]$dN.dS ~ log10(hsc70[hsc70$gene == 'ENSG00000009335',]$GenerationLength_d)))
setwd('../../../Molecular_evolution/Head/2Scripts/')
rm(list=ls(all=TRUE))
library(ggfortify)
genes <- read.table('../../Body/1_Raw/gencode.v25.annotation.gtf.Genes.Shet.pLI.FIS.RVIS.GHIS.KnKs.GC.BrainSpecificRanking.Branch', header = 1)
HSP_id <- 'ENSG00000096384'
genes_num_cols <- genes[, -c(3,4,5,7, 18)] #18 ÑÑÐ¾Ð»Ð±ÐµÑ - ÑÑÐ¾ "BrainSpecificRanking", ÑÐ±Ð¸ÑÐ°ÐµÐ¼ ÐµÐ³Ð¾ ÑÐ°Ðº ÐºÐ°Ðº Ñ HSP90 ÑÐ°Ð¼ Ð½ÐµÑ Ð½Ð°ÑÐµÐ½Ð¸Ñ
nas <- summary(genes_num_cols)[7,] #Ð¾ÑÐµÐ½Ñ Ð¼Ð½Ð¾Ð³Ð¾ Ð¿ÑÐ¾Ð¿ÑÑÐµÐ½Ð½ÑÑ Ð½Ð°ÑÐµÐ½Ð¸ÐµÐ¹ Ð² ÑÐºÐ¾ÑÐ°Ñ
genes_without_na <- na.omit(genes_num_cols) #Ð¾ÑÑÐ°ÐµÑÑÑ 2435 Ð³ÐµÐ½Ð¾Ð² Ð¸Ð· 58037.
length(unique(genes_without_na$EnsemblId)) # 11536 >> 2435 KOSTYA
DuplGenes = genes_without_na[duplicated(genes_without_na$EnsemblId),]$EnsemblId # ENSG00000167393 ENSG00000168939 ENSG00000182378 ENSG00000198223
genes_without_na = genes_without_na[!genes_without_na$EnsemblId %in% DuplGenes,] # 11532
genes_pca <- prcomp(genes_without_na[,-c(1,2)], scale. = T)
pdf('../../Body/4_Figures/hsp.like.genes.pca.pdf')
biplot(genes_pca, choices = 1:2, pc.biplot = F, col = c('white', 'black'), cex = 0.6, main = 'PCA HSP like genes', xlim = c(-0.08,0.08), xlab = 'PC1 (24% explaned var.)', ylab = 'PC2 (13.4% explaned var.)' ) # Ð¾ÑÐµÐ½Ñ ÐºÐ»ÐµÐ²Ð°Ñ ÐºÐ°ÑÑÐ¸Ð½ÐºÐ°!!!!
biplot(genes_pca, choices = 2:3, pc.biplot = F, col = c('white', 'black'), cex = 0.6, main = 'PCA HSP like genes', xlim = c(-0.08,0.08))
plot(genes_PC$PC1, genes_PC$PC2, col = 'darkslategray3', xlab = 'PC1 (24% explaned var.)', ylab = 'PC2 (13.4% explaned var.)', main = 'Subset of genes similar to HSP90', asp = 1)
points(genes_like_hsp$PC1, genes_like_hsp$PC2, col = 'red')
points(genes_like_hsp[genes_like_hsp$EnsemblId == HSP_id,'PC1'], genes_like_hsp[genes_like_hsp$EnsemblId == HSP_id,'PC2'], col = 'black', pch = '*')
legend('topright', legend = c('All genes', 'Subset of genes closed \n to hsp90', 'hsp90'), col = c('darkslategray3', 'red', 'black'), pch = c('o', 'o', '*'))
PC1 <- predict(genes_pca)[,1]
PC2 <- predict(genes_pca)[,2]
PC1_var <- summary(genes_pca)$importance[2]
PC2_var <- summary(genes_pca)$importance[5]
genes_labels <- genes_without_na[,c(1,2)]
genes_PC <- data.frame(genes_labels, PC1, PC2)
HspPc1 <- genes_PC[genes_PC$EnsemblId == HSP_id, 3]
HspPc2 <- genes_PC[genes_PC$EnsemblId == HSP_id, 4]
genes_PC$distance_to_hsp <- sqrt((HspPc1-genes_PC$PC1)**2 + (HspPc2-genes_PC$PC2)**2)
genes_like_hsp <- genes_PC[order(genes_PC$distance_to_hsp)[1:300],]
write.table(genes_like_hsp, '../../Body/2_Derived/hsp.like.genes.pca.genes.ranged.by.distance.to.hsp.txt')
groups <- read.csv('../../Body/2_Derived/human.hsp.ensID.group.txt', sep = '\t')
qtl_pred <- merge(x = groups, y = genes_PC, by.x = 'Ensembl.gene.ID', by.y = 'EnsemblId')
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = qtl_pred, aes(PC1, PC2, color = Group.name))+
geom_label_repel(data=qtl_pred[qtl_pred$Ensembl.gene.ID == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'),
box.padding   = 4,
point.padding = 0.1,
segment.color = 'grey50')+
ggtitle('biplot with hsps')+
theme_bw()
dev.off()
library(ggrepel)
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = qtl_pred, aes(PC1, PC2, color = Group.name))+
geom_label_repel(data=qtl_pred[qtl_pred$Ensembl.gene.ID == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'),
box.padding   = 4,
point.padding = 0.1,
segment.color = 'grey50')+
ggtitle('biplot with hsps')+
theme_bw()
View(genes_like_hsp)
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2, color = 'red'))+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2, color = 'cyan'))+
geom_point(data = genes_without_na[genes_without_na$EnsemblId == HSP_id,], aes(PC1, PC2, color = 'red'))
genes_without_na[genes_without_na$EnsemblId == HSP_id,]
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2, color = 'cyan'))+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2, color = 'red'))
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2, colour = 'cyan'))+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2, colour = 'red'))
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red')
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 5)
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 3, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 5
, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4
, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
theme_bw()
, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3, label = 'HSP90')+
ggtitle('')+
theme_bw()
, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2, label = 'HSP90'), colour = 'red', size = 3)+
ggtitle('')+
theme_bw()
, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
+geom_text(aes(label='HSP90'),hjust=0, vjust=0)
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
geom_text(aes(label='HSP90'),hjust=0, vjust=0)+
ggtitle('')+
theme_bw()
label="HSP90",
x=4.1,
y=20, # Rectangle size around label
label.size = 0.35,
color = "black")+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
geom_label(label="HSP90",
x=4.1,
y=20, # Rectangle size around label
label.size = 0.35,
color = "black")+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
geom_label(
label="HSP90",
x=4.1,
y=20,
label.padding = unit(0.55, "lines"), # Rectangle size around label
label.size = 0.35,
color = "black",
fill="#69b3a2"
)+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2, label = 'HSP90'), colour = 'red', size = 3)+
ggtitle('')+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2, label = 'HSP90'), colour = 'red', size = 3)+
ggtitle('')+
geom_label('HSP90')
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_label(label = 'HSP90')
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_label(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'))+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'))+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'), nudge_y = 1)+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'), nudge_y = 0.8)+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan')+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'), nudge_y = 0.6)+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan', alpha = 0.6)+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'), nudge_y = 0.6)+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan', alpha = 0.2)+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'), nudge_y = 0.6)+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan', alpha = 0.1)+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'), nudge_y = 0.6)+
theme_bw()
autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan', alpha = 0.1)+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'), nudge_y = 0.6, fontface = 'bold')+
theme_bw()
pca_plot <- autoplot(genes_pca, data = genes_without_na[,-c(1,2)], colour = 'gray', loadings = TRUE, loadings.label = TRUE, loadings.label.size = 4, scale = 0,
loadings.colour = 'black', loadings.label.colour = 'black')+
geom_point(data = genes_like_hsp, aes(PC1, PC2), colour = 'cyan', alpha = 0.1)+
geom_point(data = genes_PC[genes_PC$EnsemblId == HSP_id,], aes(PC1, PC2), colour = 'red', size = 3)+
ggtitle('')+
geom_text(data=genes_PC[genes_PC$EnsemblId == 'ENSG00000096384',], aes(PC1,PC2, label = 'HSP90'), nudge_y = 0.6, fontface = 'bold')+
theme_bw()
ggsave('../../Body/4_Figures/hsp.like.genes.old.pca.biplot.pdf', pca_plot)
install.packages("lsmeans")
rm(list=ls(all=TRUE))
data <- read.table('../../Body/2_Derived/kn.ks.genes.like.hsp.txt')
data[data == 'n/a'] <- NA
df <- c()
genes <- colnames(data)[-c(1,302)]
for (i in genes){
gene <-  gsub('dN.dS_', '',i)
a <- na.omit(data[,c('Species', i, 'Generation_Length')])
colnames(a) <- c('Species', 'kn.ks', 'Generation_Length')
Gene_id <- rep(gene, dim(a)[1])
a <- cbind(a, Gene_id)
df <- rbind(df,a)
}
df[, -c(1,4)] <- sapply(df[, -1], as.numeric)
library('lsmeans')
model <- lm(kn.ks ~ Generation_Length*Gene_id, data = df)
anova(model)
ggplot(df, aes(x=Generation_Length, y=kn.ks, col=Gene_id, alpha = 0.1), show.legend = FALSE, alpha = 0.1) +
geom_smooth(method="lm", se=FALSE , show.legend = FALSE, alpha = 0.1)
ggplot(df, aes(x=log10(Generation_Length), y=kn.ks, col=Gene_id, alpha = 0.1), show.legend = FALSE, alpha = 0.1) +
geom_smooth(method="lm", se=FALSE , show.legend = FALSE, alpha = 0.1)
rm(list=ls(all=TRUE))
df <- read.table('../../Body/2_Derived/kn.ks.genes.like.hsp.txt')
df[df == 'n/a'] <- NA
df[, -1] <- sapply(df[, -1], as.vector)
df[, -1] <- sapply(df[, -1], as.numeric)
slopes <- c()
p_val_slope <- c()
intercept <- c()
results <- read.table('../../Body/3_Results/linear.regression.kn.ks.vs.generation.length.hsp.like.genes.mammals.txt')
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for genes closed to hsp90 (red)\n n=155, p_value_slope < 0.05')
boxplot(results[results$p_val_slope < 0.05,'intercept'], ylab = 'intercept')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'intercept'], col = 'red', pch = 19)
title('Inercepts of linear regression \"Kn/Ks\" ~ \"generation length\"\n for genes closed to hsp90 (red)\n n=155, p_value_slope < 0.05')
plot(results[results$p_val_slope < 0.05,'intercept'], results[results$p_val_slope < 0.05,'slopes'],
xlab = 'intecept', ylab = 'slope')
boxplot(results[results$p_val_slope < 0.01,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
rm(list=ls(all=TRUE))
df <- read.table('../../Body/2_Derived/kn.ks.genes.like.hsp.txt')
###drawing plots
results <- read.table('../../Body/3_Results/hsp.like.genes.linear.model.results.kn.ks.vs.generation.length.mammals.right.way.zerro.intercept.txt')
boxplot(results[,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for genes closed to hsp90 (red)\n n = 177, intercept = 0')
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
boxplot(results[,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
View(results)
###drawing plots
results <- read.table('../../Body/3_Results/hsp.like.genes.linear.model.results.kn.ks.vs.generation.length.mammals.right.way.txt')
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.01,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
#do we need fiter significant p-val??
plot(results[,'intercept'], results[,'slopes'],
xlab = 'intecept', ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384','intercept'], results[results$genes == 'dN.dS_ENSG00000096384','slopes'], col = 'red', pch = 19)
install.packages("TeachingDemos")
rm(list=ls(all=TRUE))
df <- read.table('../../Body/2_Derived/kn.ks.genes.like.hsp.txt')
df[df == 'n/a'] <- NA
df[, -1] <- sapply(df[, -1], as.vector)
df[, -1] <- sapply(df[, -1], as.numeric)
hsp90 <- na.omit(df[,c('dN.dS_ENSG00000096384', 'Species', 'Generation_Length')])
hsp90_lm <- lm(scale(hsp90$dN.dS_ENSG00000096384) ~  scale(hsp90$Generation_Length), data = hsp90)
summary(hsp90_lm)
#Coefficients:
#  Estimate Std. Error t value Pr(>|t|)
#scale(hsp90$Generation_Length)   0.2864     0.1413   2.027   0.0485 *
---
#  Signif. codes:  0 â***â 0.001 â**â 0.01 â*â 0.05 â.â 0.1 â â 1
#Residual standard error: 0.9581 on 46 degrees of freedom
#Multiple R-squared:  0.08201,	Adjusted R-squared:  0.06205
#F-statistic: 4.109 on 1 and 46 DF,  p-value: 0.04846
lm_hsp90_log <- lm(log(hsp90$dN.dS_ENSG00000096384 + 0.00001) ~  log(hsp90$Generation_Length + 0.00001), data = hsp90)
#Coefficients:
#  Estimate Std. Error t value Pr(>|t|)
#scale(hsp90$Generation_Length)   0.2864     0.1413   2.027   0.0485 *
---
#  Signif. codes:  0 â***â 0.001 â**â 0.01 â*â 0.05 â.â 0.1 â â 1
#Residual standard error: 0.9581 on 46 degrees of freedom
#Multiple R-squared:  0.08201,	Adjusted R-squared:  0.06205
#F-statistic: 4.109 on 1 and 46 DF,  p-value: 0.04846
lm_hsp90_log <- lm(log10(hsp90$dN.dS_ENSG00000096384 + 0.00001) ~  log10(hsp90$Generation_Length + 0.00001), data = hsp90)
#Coefficients:
#  Estimate Std. Error t value Pr(>|t|)
#scale(hsp90$Generation_Length)   0.2864     0.1413   2.027   0.0485 *
---
#  Signif. codes:  0 â***â 0.001 â**â 0.01 â*â 0.05 â.â 0.1 â â 1
#Residual standard error: 0.9581 on 46 degrees of freedom
#Multiple R-squared:  0.08201,	Adjusted R-squared:  0.06205
#F-statistic: 4.109 on 1 and 46 DF,  p-value: 0.04846
lm_hsp90_log <- lm(log10(hsp90$dN.dS_ENSG00000096384 + 0.00001) ~  log10(hsp90$Generation_Length + 0.00001), data = hsp90)
#Coefficients:
#  Estimate Std. Error t value Pr(>|t|)
#scale(hsp90$Generation_Length)   0.2864     0.1413   2.027   0.0485 *
---
#  Signif. codes:  0 â***â 0.001 â**â 0.01 â*â 0.05 â.â 0.1 â â 1
#Residual standard error: 0.9581 on 46 degrees of freedom
#Multiple R-squared:  0.08201,	Adjusted R-squared:  0.06205
#F-statistic: 4.109 on 1 and 46 DF,  p-value: 0.04846
lm_hsp90_log <- lm(log10(hsp90$dN.dS_ENSG00000096384 + 0.00001) ~  log10(hsp90$Generation_Length + 0.00001), data = hsp90)
summary(lm_hsp90_log)
#Coefficients:
#  Estimate Std. Error t value Pr(>|t|)
#scale(hsp90$Generation_Length)   0.2864     0.1413   2.027   0.0485 *
---
#  Signif. codes:  0 â***â 0.001 â**â 0.01 â*â 0.05 â.â 0.1 â â 1
#Residual standard error: 0.9581 on 46 degrees of freedom
#Multiple R-squared:  0.08201,	Adjusted R-squared:  0.06205
#F-statistic: 4.109 on 1 and 46 DF,  p-value: 0.04846
lm_hsp90_log <- lm((hsp90$dN.dS_ENSG00000096384 + 0.00001) ~  log10(hsp90$Generation_Length + 0.00001), data = hsp90)
lm((hsp90$dN.dS_ENSG00000096384 + 0.00001) ~  log10(hsp90$Generation_Length + 0.00001), data = hsp90)
library('ggplot2')
ggplot(hsp90, aes(log10(Generation_Length + 0.00001), log10(dN.dS_ENSG00000096384 + 0.00001)))+
geom_point(size = 2)+
geom_smooth(method = 'lm', se = F, color = 'red')+
xlab('log(Generation length, days)')+
ylab('relaxation ~ log(Kn/Ks)')+
theme_bw()
###drawing plots
results <- read.table('../../Body/3_Results/hsp.like.genes.linear.model.results.kn.ks.vs.generation.length.mammals.right.way.with.log.txt')
boxplot(results[,'slopes'], ylab = 'slope')
points(results[results$genes == 'dN.dS_ENSG00000096384', 'slopes'], col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.05,'slopes'], ylab = 'slope')
points(results[(results$genes == 'dN.dS_ENSG00000096384') & (results$p_val_slope < 0.05), 'slopes'], col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.01,'slopes'], ylab = 'relaxarion ~ slope')
points(results[(results$genes == 'dN.dS_ENSG00000096384') & (results$p_val_slope < 0.01), 'slopes'], col = 'red', pch = 19)
boxplot(results[results$p_val_slope < 0.01,'slopes'], ylab = 'relaxarion ~ slope')
points(results[(results$genes == 'dN.dS_ENSG00000096384') & (results$p_val_slope < 0.01), 'slopes'], col = 'red', pch = 19)
title('Slopes of linear regression \"Kn/Ks\" ~ \"generation length\"\n for genes closed to hsp90 (red)\n n = 73')
legend('topright',legend = 'HSP90AB1', col = 'red', pch = 19)
